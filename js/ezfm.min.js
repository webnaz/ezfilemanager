function CheckifCheckBoxChecked(){var e=!1;return $("input[type='checkbox']:checked").each(function(){$(this).is(":checked")&&(e=!0)}),1==e?!0:!1}$(document).ready(function(){function hideNotifications(){var e=new Array;for(i=0;i<messageholder.length;i++)$("."+messageholder[i]).hide(),e[i]=$("."+messageholder[i]).outerHeight(),$("."+messageholder[i]).css("top",-e[i])}function doPaste(){return $.ajax({type:"POST",url:indexFile+"?folder="+folder+"&action=paste",data:{file:"paste"},success:function(e){if("error"==e)hideNotifications(),$(".errormsg").html("<h4>"+pasteError+"</h4>"),jQuery(".errormsg").show(),$(".errormsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},2e3);else if("emptyPaste"==e)hideNotifications(),$(".errormsg").html("<h4>"+pasteEmptyError+"</h4>"),jQuery(".errormsg").show(),$(".errormsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3);else{y++;var t=e.split(".");$('<tr class="success" id="tr_c'+y+'"><td style="width:10px"></td><td style="width:10px"><a href="#" id="insert_c'+y+'" alt="'+e+'" class="insert"><span class="glyphicon glyphicon-import"></span></a></td><td style="width:10px"></td><td><span id="edit_c'+y+'" alt="c'+y+'">'+t[0]+'</span><span id="ext_c'+y+'">.'+t[1]+"</span></td><td></td><td></td></tr>").prependTo("table > tbody")}}}),!0}function jeditableReset(){$("#href_"+id).unbind("click"),$("#filetype-"+id).show()}function progress(e){$("#progress").show(),0==UploadStart&&e.lengthComputable&&$("progress").attr({value:e.loaded,max:e.total})}function doMultiDelete(){$(".del").each(function(){var e=$(this);if(e.is(":checked")){var t=$("#record_"+e.attr("alt")).val(),r=$("#ext_"+e.attr("alt")).text(),i=$("#edit_"+e.attr("alt")).text();$.ajax({type:"POST",url:indexFile+"?folder="+folder+"&action=multidelete",data:{record:t,extension:r,file:i},success:function(r){""!=r?$("#response").append("<span class='alert alert-danger response'>"+r+removeError+' "'+t+'"</span>'):$("#tr_"+e.attr("alt")).remove()}})}}),setInterval(function(){$("#response").html("")},3e3)}var confirmFile,fileCopy,fileDownload,deleteFiles,createFolder,selectedFiles,maxSize,removeError,pasteError,pasteEmptyError,createError,emptycreateError,nothingError,toomanyError,invalidError,xOffset=5,yOffset=5,xPreOffset=5,yPreOffset=120,id=0,y=0,alt="",UploadStart="0",messageholder=["errormsg","successmsg","imagePreview","writable"],domain=window.location.hostname,lastChar=domain.substr(-1);if("/"!=lastChar)var domain=window.location.hostname+"/";$("#progress").hide(),$("#upload_files").hide(),$("#version-pane").html(version),$(function(){windowHeight=$(window).height(),containerHeight=windowHeight-100,console.log(containerHeight),$(".pane-home").slimScroll({height:containerHeight+"px"})}),hideNotifications(),1!=writable&&($(".writable").show(),$("#ezfm-tab a:gt(0)").hide(),$(".glyphicon-cog").hide(),$("#deleteFiles").hide(),$("#filelist td:first-child").remove(),$("#filelist th:first-child").remove()),$(".message").click(function(){$(this).animate({top:-$(this).outerHeight()},500)}),i18n.init({lng:lang,debug:!0,fallbackLng:"en",load:"unspecific",resGetPath:"lng/__ns__-__lng__.json",ns:{namespaces:["translation"],defaultNs:"translation"}},function(e){$("#all").i18n(),confirmFile=e("form.confirmFile"),fileCopy=e("form.fileCopy"),fileDownload=e("form.fileDownload"),deleteFiles=e("form.deleteFiles"),createFolder=e("form.createFolder"),selectedFiles=e("form.selectedFiles"),maxSize=e("form.maxSize"),removeError=e("error.removeError"),pasteError=e("error.pasteError"),pasteEmptyError=e("error.pasteEmptyError"),createError=e("error.createError"),emptycreateError=e("error.emptycreateError"),nothingError=e("error.nothingError"),toomanyError=e("error.toomanyError"),invalidError=e("error.invalidError"),tooLargeError=e("error.tooLargeError")}),$(function(){$("#ezfm-tab a:first").tab("show")}),$(document).on("click",".preview",function(e){var t="",r=$(this).attr("id").split("-");id=r[1];var i=$(this).attr("alt"),o=$("#width"+id).attr("alt"),n=$("#height"+id).attr("alt");t+="<div  class='thumbnail'>",t+="<img src='/"+folder+i+"' id='previewid' style='width:"+o+"px;height:"+n+"px' class='img-responsive'>",t+="</div>",$("#preview").html(t),$("#preview").css("top",e.pageY-n+"px").css("left",e.pageX+xPreOffset+"px"),$("#preview").fadeIn("fast")}),$(".preview").bind("mouseleave",function(){$("#preview").hide(),$("#preview").html("")}),$(document).on("click","a.dropdown-actions",function(e){if($(".tools").is(":visible"))$(".tools").hide();else{var t=$(this).attr("id"),r=$(this).attr("alt");$("ul.toolsli:lt(2)").show(),"folder"==r&&$("ul.tools li:lt(2)").hide(),$(".download").attr("id",t),$(".download").attr("alt",r),$(".filedelete").attr("id",t),$(".copy").attr("id",t),$(".rename").attr("id",t),$(".tools").show(),menuHeight=$(".tools").height(),$("#actions-options").css("top",e.pageY-menuHeight-yOffset+"px").css("left",e.pageX-xOffset+"px")}e.preventDefault?e.preventDefault():e.returnValue=!1}),$(".tools").bind("mouseleave",function(){$(".tools").hide()}),$(document).on("click","a.insert",function(e){var t=$(this).attr("id").split("_");id=t[1];var r=$("#ext_"+id).text(),i=$("#edit_"+id).text();if(null!=window.name&&""!=window.name)console.log("Plugin mode"),fileName=decodeURI("/"+folder+i+r),$(opener.document.getElementsByName(window.name)).val(fileName),$(opener.document.getElementsByName(window.name)).focus(),self.close();else try{console.log("PTinyMCE mode"),ezDialogue.fileSubmit(http+domain+folder+i+r)}catch(o){console.log("Standalone mode")}$(".tools").hide(),e.preventDefault?e.preventDefault():e.returnValue=!1}),$(document).on("click","a.insert-plugin",function(e){var t=$(this).attr("id").split("_");id=t[1];var r=$("#ext_"+id).text(),i=$("#edit_"+id).text();try{fileName=decodeURI("/"+folder+i+r),$(opener.document.getElementsByName(window.name)).val(fileName),$(opener.document.getElementsByName(window.name)).focus(),self.close()}catch(o){console.log("Plugin mode")}$(".tools").hide(),e.preventDefault?e.preventDefault():e.returnValue=!1});var ezDialogue={init:function(){var e=document.getElementsByTagName("link");e[e.length-1].parentNode.removeChild(e[e.length-1])},fileSubmit:function(e){var t=e,r=top.tinymce.activeEditor.windowManager.getParams().window;r.document.getElementById(top.tinymce.activeEditor.windowManager.getParams().input).value=t,top.tinymce.activeEditor.windowManager.close()}};$("a.download").click(function(e){id=$(this).attr("id");var t=$("#ext_"+id).text(),r=$("#edit_"+id).text();$(".tools").hide(),hideNotifications(),$(".successmsg").html("<h4>"+fileDownload+" "+r+t+"</h4>"),jQuery(".successmsg").show(),$(".successmsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3),window.location.href=location.protocol+"//"+location.host+location.pathname+"?folder="+folder+"&action=download&file="+r+t,e.preventDefault?e.preventDefault():e.returnValue=!1}),$("a.copy").click(function(e){id=$(this).attr("id");var t=$("#ext_"+id).text(),r=$("#edit_"+id).text();$(".tools").hide(),hideNotifications(),$(".successmsg").html("<h4>"+r+t+" "+fileCopy+"</h4>"),jQuery(".successmsg").show(),$(".successmsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3),$.ajax({type:"POST",url:indexFile+"?folder="+folder+"&action=copy",data:{file:r,extension:t},success:function(e){""!=e&&($("#response").html("<span class='alert alert-danger response'>"+e+"</span>"),setInterval(function(){$("#response").html("")},3e3))}}),e.preventDefault?e.preventDefault():e.returnValue=!1}),$(".editable").click(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}),$(document).on("click","a.rename",function(e){id=$(this).attr("id"),$("#href_"+id).click(function(){return!1});var t=$("#ext_"+id).text(),r=$("#edit_"+id).text();$.post(indexFile+"?folder="+folder+"&action=oldfilename",{oldfilename:r,extension:t}),$("#filetype-"+id).hide(),$("#edit_"+id).trigger("rename"),$(".tools").hide(),e.preventDefault?e.preventDefault():e.returnValue=!1}),$.editable.addInputType("no-space",{element:$.editable.types.text.element,plugin:function(){$("input",this).bind("keypress",function(e){var t=$(this).val(),r=new RegExp("^[a-zA-Z0-9-_ ]*$");return t=String.fromCharCode(e.charCode?e.charCode:e.which),r.test(t)?!0:(e.preventDefault?e.preventDefault():e.returnValue=!1,!1)}),$("input",this).blur(function(){$("#href_"+id).unbind("click");var e=$.trim($(this).val());1==removeSpace&&(e=e.replace(/\s{2,}/g," "),e=e.replace(/\s/g,"-")),$("#href_"+id).attr("href",indexFile+"?folder="+folder+e),$(this).val(e)})}}),$(".edit_area").editable(indexFile+"?folder="+folder+"&action=rename",{type:"no-space",submitdata:{_method:"POST"},select:!0,submit:"OK",cancel:"cancel",cssclass:"editable",onreset:jeditableReset,event:"rename",callback:function(){$("#href_"+id).unbind("click"),$("#filetype-"+id).show()}}),$(document).on("click","a.filedelete",function(e){id=$(this).attr("id"),file_extension=$("#ext_"+id).text();var t=$("#edit_"+id).text(),r=confirm(confirmFile+" "+t+file_extension+"?");1==r?($.ajax({type:"POST",url:indexFile+"?folder="+folder+"&action=delete",data:{file:t,extension:file_extension},success:function(e){""!=e?($("#response").html("<span class='alert alert-danger response'>"+removeError+' "'+e+'"</span>'),setInterval(function(){$("#response").html("")},3e3)):($(this).closest("tr").remove(),$("#tr_"+id).remove())}}),e.preventDefault?e.preventDefault():e.returnValue=!1):e.preventDefault?e.preventDefault():e.returnValue=!1}),$(document).on("click","a.ajaxdelete",function(e){id=$(this).attr("id"),file_extension=$("#ext_"+id).text();var t=$("#edit_"+id).text(),r=confirm(confirmFile+" "+t+file_extension+"?");1==r?($.ajax({type:"POST",url:indexFile+"?folder="+folder+"&action=delete",data:{file:t,extension:file_extension},success:function(e){""!=e?($("#response").html("<span class='alert alert-danger response'>"+removeError+' "'+e+'"</span>'),setInterval(function(){$("#response").html("")},3e3)):$("#tr_"+id).remove()}}),e.preventDefault?e.preventDefault():e.returnValue=!1):e.preventDefault?e.preventDefault():e.returnValue=!1}),$("#foldercreate",this).bind("keypress",function(e){var t=$(this).val(),r=new RegExp("^[a-zA-Z0-9-_s\r\n ]*$");return t=String.fromCharCode(e.charCode?e.charCode:e.which),r.test(t)?!0:(e.preventDefault?e.preventDefault():e.returnValue=!1,!1)}),$("#foldercreateForm").submit(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$("textarea[name=foldercreate]").val().split("\n");"undefined"==typeof y&&(y=1),$.each(t,function(){var t=$.trim(this);1==removeSpace&&(t=t.replace(/\s{2,}/g," "),t=t.replace(/\s/g,"-")),""!=t&&($.ajax({type:"POST",url:indexFile+"?folder="+folder+"&action=createfolder",data:{directory:t},success:function(e){"error"==e?$("#response").append("<span class='alert alert-danger response'>"+createError+": "+t+"</span>"):"empty"==e?$("#response").append("<span class='alert alert-danger response'>"+emptycreateError+"</span>"):(y++,$('<tr class="success" id="tr_a'+y+'"><td style="width:10px"><input type="checkbox" id="record_a'+y+'" value="'+e+'" class="del" name="_del[a'+y+']" alt="a'+y+'"></td><td style="width:10px"></td><td style="width:10px"><a id="a'+y+'" class="ajaxdelete"  alt="folder" href="#"><span class="glyphicon glyphicon-trash"></span></a></td><td colspan="3"><a href="'+indexFile+"?folder="+folder+e+'/" id="href_a'+y+'"><span class="glyphicon glyphicon-folder-open"></span>&nbsp;&nbsp;<span id="edit_a'+y+'" alt="a'+y+'">'+e+'</span><span id="ext_a'+y+'"></span></a></td></tr>').prependTo("table > tbody"),$("#emptyTable").remove())}}),setInterval(function(){$("#response").html("")},3e3),$("textarea[name=foldercreate]").val(""),$("#ezfm-tab a:first").tab("show"),$(".pane-home").slimScroll({scrollTo:"0px"}),e.preventDefault?e.preventDefault():e.returnValue=!1)})}),$("#type-control").change(function(){window.location.href=location.protocol+"//"+location.host+location.pathname+"?folder="+folder+"&type="+this.value}),$("#uploadForm").submit(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(".filetoupload").val(),r=$("#filetoupload")[0].files;if(r.length>maxFileUpload)return hideNotifications(),$(".errormsg").html("<h4>"+r.length+" "+selectedFiles+": "+maxFileUpload+" "+toomanyError+"</h4>"),jQuery(".errormsg").show(),$(".errormsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3),!1;for(var i=0;i<r.length;i++){var o=r[i].type.split("/");if(console.log(r[i].name,r[i].type,r[i].size,o[1]),!valid_extensions.test(r[i].name))return hideNotifications(),$(".errormsg").html("<h4>"+r[i].name+" "+invalidError+"</h4>"),jQuery(".errormsg").show(),$(".errormsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3),!1;if(r[i].size>maxFileSize)return hideNotifications(),$(".errormsg").html("<h4>"+r[i].name+" "+tooLargeError+"</h4>"),jQuery(".errormsg").show(),$(".errormsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3),!1}if(t){var n=new FormData($("#uploadForm")[0]);$.ajax({url:indexFile+"?folder="+folder+"&action=upload",type:"POST",xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",progress,!1),e},data:n,cache:!1,contentType:!1,processData:!1,success:function(e){$(e).prependTo("table > tbody"),$("#progress").hide(),$("#upload_files").html(""),$("#upload_files").hide(),$("#emptyTable").remove(),$("#ezfm-tab a:first").tab("show"),$("html, body").animate({scrollTop:0},"slow"),$("html, body").animate({scrollTop:0},"slow"),$(".pane-home").slimScroll({scrollTo:"0px"})}}),$("#uploadForm")[0].reset()}return!0}),$(".btn-file :file").on("fileselect",function(e,t,r){var i=$(this).parents(".input-group").find(":text"),o=t>1?t+" "+selectedFiles:r;i.val(o)}),$(document).on("change",".btn-file :file",function(){$("#upload_files").html("");var e=$("#filetoupload")[0].files;if(e.length>1){for(var t=0;t<e.length;t++)$("#upload_files").append('"'+e[t].name+'" ');$("#upload_files").show()}var r=$(this),i=r.get(0).files?r.get(0).files.length:1,o=r.val().replace(/\\/g,"/").replace(/.*\//,"");r.trigger("fileselect",[i,o])}),$("#selectSelects").click(function(){var e=this.checked;$("#filelist tbody tr").find("td:first :checkbox").each(function(){$(this).prop("checked",e)})}),$("#pagerefresh").click(function(){document.location.reload()}),$("#logout").click(function(){document.location.href="?logout=1"}),$(function(){$(".multiaction").click(function(){if(id=$(this).attr("id"),"pasteFiles"==id)return doPaste(),!0;if(CheckifCheckBoxChecked()){var delMsg=confirm(eval($(this).attr("id")));return 1==delMsg?(id=$(this).attr("id"),"deleteFiles"!=id?!1:(doMultiDelete(),!1)):!1}return hideNotifications(),$(".errormsg").html("<h4>"+nothingError+"</h4>"),jQuery(".errormsg").show(),$(".errormsg").animate({top:"0"},500),setTimeout(function(){hideNotifications()},3e3),!1})}),$.fn.redraw=function(){$(this).each(function(){this.offsetHeight;console.log("Repainting")})},$(".container").redraw()}),DEBUG_MODE||(console=console||{},console.log=function(){});